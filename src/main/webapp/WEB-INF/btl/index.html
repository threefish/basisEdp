<%
layout("/layouts/platform.html",{title:"系统首页"}){
%>
<script type="text/javascript" src="${base!}/static/plugins/echarts/echarts.js"></script>
<section class="content">
    <div id="line" style="width: 800px;height:400px;"></div>
</section>
<script type="text/javascript">
    function showEcharts() {
        $.post('${base!}/monitor/apm/data', {type: "ALL"}, function (result) {
            var option = {
                title: {
                    text: ''
                },
                tooltip: {
                    trigger: 'axis',
                    axisPointer: {
                        animation: false
                    }
                },
                legend: {
                    data: ['CPU', 'JVM', 'RAM', 'SWAP', 'NETWORK IN', 'NETWORK OUT']
                },
                toolbox: {
                    show: true,
                    feature: {
                        restore: {},
                        saveAsImage: {}
                    }
                },
                dataZoom: {
                    show: false,
                    start: 0,
                    end: 100
                },
                xAxis: [{
                    type: 'category',
                    boundaryGap: true,
                    data: result.data.timePoints
                }],
                yAxis: [{
                    type: 'value',
                    scale: true,
                    name: '百分比',
                    max: 100,
                    min: 0,
                    boundaryGap: [0.2, 0.2]
                }, {
                    type: 'value',
                    scale: true,
                    max: 5000,
                    min: 0,
                    name: ' k/s',
                    boundaryGap: [0.2, 0.2]
                }],
                series: [{
                    name: 'CPU',
                    type: 'line',
                    smooth: true,
                    data: result.data.cpuUsages
                }, {
                    name: 'JVM',
                    type: 'line',
                    smooth: true,
                    data: result.data.jvmUsages
                }, {
                    name: 'RAM',
                    type: 'line',
                    smooth: true,
                    data: result.data.ramUsages
                }, {
                    name: 'SWAP',
                    type: 'line',
                    smooth: true,
                    yAxisIndex: 0,
                    data: result.data.swapUsages
                }, {
                    name: 'NETWORK IN',
                    type: 'line',
                    smooth: true,
                    yAxisIndex: 1,
                    data: result.data.niUsages
                }, {
                    name: 'NETWORK OUT',
                    type: 'line',
                    smooth: true,
                    yAxisIndex: 1,
                    data: result.data.noUsages
                }]
            };
            console.log(result.data)
            line.setOption(option);
        }, 'json');
    }
    var line;
    $(function () {
        line = echarts.init($("#line").get(0));
        showEcharts();
    });


</script>
<%}%>