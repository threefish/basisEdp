<%
layout("/layouts/platform.html",{title:"系统首页"}){
%>
<script type="text/javascript" src="${base!}/static/plugins/echarts/echarts.js"></script>
<section class="content">
    <div id="line" style="width: 600px;height:400px;"></div>
</section>
<script type="text/javascript">
    var line;
    function showEcharts() {
        $.post('${base!}/monitor/apm/data', {type: "ALL"}, function (result) {
            var option = {
                title: {
                    text: '',
                },
                tooltip: {
                    trigger: 'axis'
                },
                legend: {
                    data: ['CPU', 'JVM', 'RAM', 'SWAP', 'NETWORK IN', 'NETWORK OUT']
                },
                toolbox: {
                    show: true,
                    feature: {
                        restore: {},
                        saveAsImage: {}
                    }
                },
                dataZoom: {
                    show: false,
                    start: 0,
                    end: 100
                },
                xAxis: [{
                    type: 'category',
                    boundaryGap: true,
                    data: ["18:08:56", "18:08:58", "18:09:00", "18:09:02", "18:09:04", "18:09:06", "18:09:08", "18:09:10", "18:09:12", "18:09:14", "18:09:16", "18:09:18", "18:09:20", "18:09:22", "18:09:24", "18:09:26", "18:09:28", "18:09:30", "18:09:32", "18:09:34", "18:09:36", "18:09:38", "18:09:40", "18:09:42", "18:09:44"],
                    "cpuUsages": ["8.26", "0.50", "0.50", "0.75", "1.13", "7.89", "0.38", "0.75", "0.38", "0.50", "8.02", "0.63", "0.63", "0.50", "0.38", "2.26", "6.26", "0.63", "0.50", "0.75", "0.63", "7.77", "0.63", "0.50", "0.63"],
                    "ramUsages": ["18.33", "18.33", "18.33", "18.33", "18.33", "18.33", "18.33", "18.33", "18.33", "18.33", "18.34", "18.34", "18.34", "18.34", "18.34", "18.34", "18.34", "18.34", "18.34", "18.34", "18.34", "18.34", "18.34", "18.34", "18.34"],
                    "jvmUsages": ["7.00", "7.00", "7.00", "7.00", "7.00", "18.00", "18.00", "18.00", "18.00", "18.00", "4.00", "4.00", "4.00", "4.00", "4.00", "7.00", "16.00", "16.00", "16.00", "16.00", "16.00", "27.00", "27.00", "27.00", "27.00"],
                    "swapUsages": ["0.00", "0.00", "0.00", "0.00", "0.00", "0.00", "0.00", "0.00", "0.00", "0.00", "0.00", "0.00", "0.00", "0.00", "0.00", "0.00", "0.00", "0.00", "0.00", "0.00", "0.00", "0.00", "0.00", "0.00", "0.00"],
                    "niUsages": ["0.00", "0.00", "0.00", "0.00", "0.00", "0.00", "0.00", "0.00", "0.00", "0.00", "0.00", "0.00", "0.00", "0.00", "0.00", "0.00", "0.00", "0.00", "0.00", "0.00", "0.00", "0.00", "0.00", "0.00", "0.00"],
                    "noUsages": ["0.00", "0.00", "0.00", "0.00", "0.00", "0.00", "0.00", "0.00", "0.00", "0.00", "0.00", "0.00", "0.00", "0.00", "0.00", "0.00", "0.00", "0.00", "0.00", "0.00", "0.00", "0.00", "0.00", "0.00", "0.00"]
                }],
                yAxis: [{
                    type: 'value',
                    scale: true,
                    name: '百分比',
                    max: 100,
                    min: 0,
                    boundaryGap: [0.2, 0.2]
                }, {
                    type: 'value',
                    scale: true,
                    max: 5000,
                    min: 0,
                    name: ' k/s',
                    boundaryGap: [0.2, 0.2]
                }],
                series: [{
                    name: 'CPU',
                    type: 'line',
                    smooth: true,
                    data: result.data.cpuUsages
                }, {
                    name: 'JVM',
                    type: 'line',
                    smooth: true,
                    data: result.data.jvmUsages
                }, {
                    name: 'RAM',
                    type: 'line',
                    smooth: true,
                    data: result.data.ramUsages
                }, {
                    name: 'SWAP',
                    type: 'line',
                    smooth: true,
                    yAxisIndex: 0,
                    data: result.data.swapUsages
                }, {
                    name: 'NETWORK IN',
                    type: 'line',
                    smooth: true,
                    yAxisIndex: 1,
                    data: result.data.niUsages
                }, {
                    name: 'NETWORK OUT',
                    type: 'line',
                    smooth: true,
                    yAxisIndex: 1,
                    data: result.data.noUsages
                }]
            };
            line.setOption(option);
        }, 'json');
    }

    $(function () {
        line = echarts.init(document.getElementById('line'));
        showEcharts();
    });
</script>
<%}%>